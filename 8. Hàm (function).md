# Hàm (Function) trong C++

## 1. Khái niệm

- Hàm (function) là một khối lệnh được đặt tên thực hiện một nhiệm vụ cụ thể.  
- Hàm giúp tách chương trình thành các phần nhỏ, dễ đọc, tái sử dụng và kiểm thử.

---

## 2. Cấu trúc cơ bản của hàm

- Khai báo (prototype): cho trình biên dịch biết tên hàm, kiểu trả về và tham số.
- Định nghĩa (definition): thân hàm chứa các câu lệnh thực thi.
- Gọi hàm (call): sử dụng tên hàm ở nơi cần thực hiện.

Cú pháp:
```cpp
// Khai báo (tùy chọn nếu định nghĩa trước chỗ gọi)
int add(int a, int b);

// Định nghĩa
int add(int a, int b) {
    return a + b;
}

// Gọi hàm
int s = add(3, 4); // s = 7
```

---

## 3. Kiểu trả về và từ khóa void

- Hàm trả về một giá trị có kiểu xác định (ví dụ: int, double, string).
- Nếu hàm không trả về giá trị, dùng `void`.

Ví dụ:
```cpp
void printHello() {
    std::cout << "Hello\n";
}

int square(int x) {
    return x * x;
}
```

---

## 4. Tham số: truyền theo giá trị (pass-by-value) và truyền theo tham chiếu (pass-by-reference)

### 4.1. Truyền theo giá trị (pass-by-value)
- Mặc định trong C++: khi gọi hàm, các tham số cơ bản được truyền theo giá trị — hàm nhận một bản sao của đối số.
- Thay đổi giá trị tham số trong hàm không ảnh hưởng tới biến gốc ở bên ngoài.

Ví dụ:
```cpp
void inc(int x) { // x là bản sao của đối số
    x = x + 1;
}

int main() {
    int a = 5;
    inc(a);
    // a vẫn là 5
}
```

Với các kiểu dữ liệu lớn (ví dụ `std::string`, `std::vector`), việc truyền theo giá trị sẽ sao chép toàn bộ dữ liệu — có thể tốn chi phí. Khi muốn tránh sao chép và/hoặc muốn sửa trực tiếp biến gốc, cân nhắc sử dụng truyền theo tham chiếu (xem phần 4.2).

---

### 4.2. Truyền theo tham chiếu (pass-by-reference)
- Dùng ký hiệu `&` trong khai báo tham số để truyền theo tham chiếu.
- Hàm nhận một alias (tham chiếu) đến biến thực tế; thay đổi tham số trong hàm sẽ thay đổi biến gốc.

Ví dụ (thay đổi giá trị):
```cpp
void incByRef(int &x) {
    x = x + 1;
}

int main() {
    int a = 5;
    incByRef(a);
    // a bây giờ là 6
}
```

Ví dụ (hoán đổi hai biến bằng tham chiếu):
```cpp
void swapRef(int &x, int &y) {
    int tmp = x;
    x = y;
    y = tmp;
}

int main() {
    int p = 2, q = 3;
    swapRef(p, q);
    // p = 3, q = 2
}
```

Lưu ý:
- Tham chiếu phải gắn với một biến hợp lệ khi gọi hàm (không thể truyền một giá trị tạm thời cho tham chiếu không const).
- Dùng tham chiếu khi cần hàm thay đổi trực tiếp đối số hoặc muốn tránh sao chép lớn.

---

## 5. Tham số mặc định (default arguments)

- Có thể gán giá trị mặc định cho tham số ở khai báo/định nghĩa.

Ví dụ:
```cpp
int add(int a, int b = 10) {
    return a + b;
}
add(5);    // trả về 15
add(5, 3); // trả về 8
```

---

## 6. Nạp chồng hàm (Function Overloading)

- C++ cho phép nhiều hàm cùng tên với khác danh sách tham số.
- Trình biên dịch phân biệt theo kiểu và số tham số.

Ví dụ:
```cpp
int max(int a, int b) { return (a > b) ? a : b; }
double max(double a, double b) { return (a > b) ? a : b; }
```

---

## 7. Đệ quy (Recursion)

- Hàm gọi chính nó. Phải có điều kiện dừng (base case) để tránh vòng lặp vô hạn.

Ví dụ tính giai thừa (không khuyến nghị cho n quá lớn):
```cpp
unsigned long long fact(unsigned int n) {
    if (n <= 1) return 1;
    return n * fact(n - 1);
}
```

---

## 8. Phạm vi (scope) và vòng đời (lifetime)

- Biến cục bộ (local) khai báo trong hàm chỉ tồn tại trong hàm đó.
- Biến toàn cục (global) có phạm vi toàn chương trình (dùng cẩn trọng).
- `static` local giữ giá trị giữa các lần gọi hàm.

Ví dụ `static`:
```cpp
void counter() {
    static int cnt = 0;
    cnt++;
    std::cout << cnt << std::endl;
}
```

---

## 9. Ví dụ tổng hợp

```cpp
#include <iostream>
#include <string>

int add(int a, int b = 0) {
    return a + b;
}

void swapRef(int &x, int &y) {
    int tmp = x;
    x = y;
    y = tmp;
}

bool isPrime(int n) {
    if (n < 2) return false;
    for (int i = 2; i * i <= n; ++i)
        if (n % i == 0) return false;
    return true;
}

int main() {
    std::cout << "add(3,4) = " << add(3,4) << std::endl;
    std::cout << "add(5) = " << add(5) << std::endl; // dùng tham số mặc định

    int a = 2, b = 5;
    swapRef(a, b);
    std::cout << "a = " << a << ", b = " << b << std::endl;

    int n = 13;
    std::cout << n << " is prime? " << (isPrime(n) ? "YES" : "NO") << std::endl;

    return 0;
}
```

---

## 10. Tổng kết

- Hàm là công cụ quan trọng để tổ chức và tái sử dụng mã.  
- Hiểu rõ cách truyền tham số (value, reference), phạm vi biến, và cách quản lý giá trị trả về sẽ giúp viết chương trình an toàn và hiệu quả hơn.

---